<!DOCTYPE html>
 

<html>
<head>
    <title> Snake Game </title>
    <style type="text/css">
        body {
            margin: 0 auto;
            padding : 0;
        }
    </style>
    
    
    <!-- Jquery -->
    <script    src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script>
       $(document).ready(function () {
            //Canvas variables to be used within the game
            var drawCanvas = $("#drawCanvas")[0];
            var ctx = drawCanvas.getContext("2d");
            var width = $("#drawCanvas").width();
            var height = $("#drawCanvas").height();
 
           var cell_width = 15;
            var defaultRun;
           //Snake's food will be an apple in the game
            var apple;
           var userscore;
            var mySnakeArray;
           
//Starts the game and defaults the snake to run right by default when the game starts 
           function start() {
                defaultRun = "right";
                createSnake();
                createApple();
                userscore = 0;

//clears background and repaints snake every 70ms     
                if (typeof game_loop != "undefined") clearInterval(game_loop);
                game_loop = setInterval(paintSnake, 70);
            }
            start();
 
//Creates a snake 5 cells long and adds cells to back of snake to increase length
            function createSnake() {
                var snakeSize = 6;
                mySnakeArray = [];
                for (var m = 0; m<snakeSize-1;m++) {
                    mySnakeArray.push({ x: 0, y: 20 });
                }
            }
            
//creates the snake's food and keeps it within the borders
            function createApple() {
                snake_apple = {
                    x: Math.round(Math.random() * (width - cell_width) /                            cell_width),
                    y: Math.round(Math.random() * (height -                               cell_width) / cell_width),
                };
             }
            
 
   //paints the game background pink and the border blue        
            function paintSnake() {
            ctx.fillStyle = "#FFCCFF";
            ctx.fillRect(0, 0, width, height);
            ctx.strokeStyle = "#3300FF";
            ctx.strokeRect(0, 0, width, height);
    
    //this makes it easier to use x and y in the future
                var pop_x = mySnakeArray[0].x;
                var pop_y = mySnakeArray[0].y;
 
    //these allow snake to run up, down, left and right in the game
                 if (defaultRun == "right") pop_x++;
                else if (defaultRun == "left") pop_x--;
                else if (defaultRun == "down") pop_y++;
                else if (defaultRun == "up") pop_y--;
               
 // covering all areas making sure everything stays within the borders of the game
                 if (pop_x == -1 || pop_x == width / cell_width || pop_y == -1 || pop_y == height / cell_width || check_collision(pop_x, pop_y, mySnakeArray)) 
                 {
                     start();
                     return;
                 }
 
//Updates score to add 1 when an apple is eaten and creates a new apple, also handles the snake colliding with itself to end the game
                  if (pop_x == snake_apple.x && pop_y == snake_apple.y) {
                    var snake_tail = { x: pop_x, y: pop_y };
                    userscore++;
                     createApple();
                }
                else {
                    var snake_tail = mySnakeArray.pop();
                    snake_tail.x = pop_x; snake_tail.y = pop_y;
                }
 
//Ensures that new cell is added to back of snake rather than front and also paints the added cell
                mySnakeArray.unshift(snake_tail);
 
                for (var i = 0; i < mySnakeArray.length; i++) {
                    var s = mySnakeArray[i];
                
                    paintCell(s.x, s.y);
                }
 
//Writes score to the screen and also paints it
              paintCell(snake_apple.x, snake_apple.y);
               
                var score_text = "Score: " + userscore;
                ctx.fillText(score_text, width-50, 20);
            }

 //Paints snake cells to orange and the borders of the cells to red
           function paintCell(x, y) {
        ctx.fillStyle = "orange";
        ctx.fillRect(x * cell_width, y * cell_width, cell_width,        cell_width);
        ctx.strokeStyle = "red";
        ctx.strokeRect(x * cell_width, y * cell_width, cell_width,      cell_width);
    }
 
 //Some collision detection to ensure that the snake stays within the borders of the game
            function check_collision(x, y, array) {
        for (var i = 0; i < array.length; i++) {
               if (array[i].x == x && array[i].y == y)
                     return true;
                }
                return false;
            }
  
//Ensures that the user can input so that when you press the up, down, left and right arrow keys that the snake moves in those directions
        $(document).keypress(function (e) {
                var keyInput = e.which;
                if (keyInput == "40" && defaultRun != "up") defaultRun = "down";
                else if (keyInput == "37" && defaultRun != "right") defaultRun = "left";
                else if (keyInput == "39" && defaultRun != "left") defaultRun = "right";
                else if (keyInput == "38" && defaultRun != "down") defaultRun = "up";
            })
        })
 
   </script>
</head>
<body>
        <div>
            //Canvas has to be 600 as even if it is 550 the collision detection messes up abd the snake runs right through the wall on the right hand side
             <canvas id="drawCanvas" width="550" height="600"></canvas>
        </div>
</body>
</html>